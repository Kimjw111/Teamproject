<!-- index.html -->
<!DOCTYPE html>
<html>
  <head>
    <title>1조 채팅방(김정우,구병오,김성준)</title>
  </head>
  <style>
    body,
    html {
      width: 100%;
      height: 100%;
      margin: 0;
      background: rgb(205, 236, 240);
    }
    body::-webkit-scrollbar {
      display: none;
    }
    /* #container {
      width: 100%;
      height: 100%;
      margin: 0;
    } */
    #header {
      width: 100%;
      margin: 0;
      background: rgb(167, 201, 206);
      overflow: hidden;
    }
    #title {
      color: #000;
      animation: movetitle 10s infinite linear;
    }
    @keyframes movetitle {
      from {
        transform: translateX(1800px);
      }
      to {
        transform: translateX(-600px);
      }
    }
    #chat {
      height: 100%;
      width: 100%;
      overflow-y: scroll;
    }
    #messages {
      list-style: none;
      display: inline-block;
    }
    li {
      padding: 10px;
      margin: 5px 0;
      border-radius: 10px;
      background: #fff;
    }
    #chat::-webkit-scrollbar {
      display: none;
    }

    #message-form {
      background: rgb(171, 202, 207, 0.2);
      padding: 0.25rem;
      position: fixed;
      width: 100%;
      display: flex;
      justify-content: space-around;
      bottom: 0;
      height: 3rem;
      box-sizing: border-box;
      backdrop-filter: blur(10px);
    }
    #input {
      border: none;
      border-radius: 2rem;
      width: 85%;
      height: 80%;
      font-size: 1.5em;
      margin: auto 0;
    }
    #send_btn {
      width: 80px;
      height: 40px;
      border-radius: 10px;
      border: none;
      background: #fff;
      transition: 0.15s ease-in;
    }
    #send_btn:hover {
      background: #97b6b1;
      transform: scale(1.01);
    }
  </style>
  <body>
    <div id="container">
      <div id="header">
        <h1 id="title">Whale-Chat</h1>
      </div>
      <div id="chat">
        <ul id="messages"></ul>
      </div>
      <form id="message-form">
        <input id="input" autocomplete="off" />
        <button id="send_btn">전송</button>
      </form>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io();

      // 로그인
      const username = prompt("대화명을 입력하세요 (익명 또는 원하는 이름)");
      socket.emit("login", username);

      // 채팅 메시지 전송
      document
        .getElementById("message-form")
        .addEventListener("submit", (e) => {
          e.preventDefault();
          const input = document.getElementById("input");
          const message = input.value;
          input.value = "";
          socket.emit("chat message", { message: message });
        });

      // 채팅 메시지 받기
      socket.on("chat message", (msg) => {
        const messages = document.getElementById("messages");
        const item = document.createElement("li");
        item.textContent = `[${msg.from}] ${msg.message}`;
        messages.appendChild(item);
        window.scrollTo(0, document.body.scrollHeight);
      });
    </script>
  </body>
</html>
